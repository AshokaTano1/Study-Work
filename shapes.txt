def CreateDeleteOrUpdateRecords(model, user, data, folder):
    # Поиск уже созданных значений в конкретной папке
    existingRecordsDict = {record.id: record for record in model.objects.filter(user=user, inFolder=folder).in_bulk().values()}
    for item in data:
        item.pop('added', None)
        item.pop('gateFileHash', None)
        item.pop('gateFileUpdated', None)
        item.pop('x', None)
        if "new" in item['id']:
            item.pop('id', None)
            item['user'] = user
            item['inFolder'] = folder
            model.objects.create(**item)
        else:
            id = int(item['id'].split('-')[-1])
            item.pop('id', None)
            record = existingRecordsDict[id]
            for field, value in item.items():
                setattr(record, field, value)
            record.save()
            del existingRecordsDict[id]
    # Удаление оставшихся элементов из БД, если они не были обновлены
    for id in existingRecordsDict:
        existingRecordsDict[id].delete()
